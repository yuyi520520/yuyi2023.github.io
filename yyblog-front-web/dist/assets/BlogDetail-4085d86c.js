import{H as D}from"./atom-one-light-f4d8b779.js";import{k as w,i as S,r,a as b,o as n,c,b as e,t as i,g as d,d as _,e as h,F as C,f as H,l as N,m as T}from"./index-1ca88f23.js";const L={class:"detail_main"},q={class:"left"},A={class:"title"},E={class:"info"},R={class:"time"},V={class:"nick_name"},z={class:"category_name"},F=["innerHTML"],M=e("div",{class:"part_title"},[e("span",{class:"fonts"},"目录结构")],-1),J={class:"list"},U={key:0,class:"notoc"},W=["href"],j={class:"part_title"},G=e("span",{class:"fonts"},"分类专栏",-1),K={class:"c_list"},Z={__name:"BlogDetail",setup(O){const x=w(),{proxy:p}=S(),y={blogDetail:"/view/getBlogDetail",loadCategory:"/view/loadCategory"},g=r(1050+(window.innerWidth-1350)/2),B=r(x.params.blogId),a=r({});(async()=>{let o=await p.Request({url:y.blogDetail,params:{blogId:B.value}});o&&(a.value=o.data,T(()=>{document.querySelectorAll("pre code").forEach(l=>{D.highlightBlock(l)}),I(),document.body.scrollHeight>window.innerHeight&&(g.value=g.value-4)}))})();const m=r([]);(async()=>{let o=await p.Request({url:y.loadCategory,params:{pageSize:5}});o&&(m.value=o.data)})();const u=r([]),I=()=>{const o=["H1","H2","H3","H4","H5","H6"],s=document.querySelector("#content").childNodes;u.value=[];let l=0;s.forEach(t=>{let v=t.tagName;if(v==null||!o.includes(v.toUpperCase()))return!0;l++;let k="toc"+l;t.setAttribute("id",k),u.value.push({id:k,title:t.innerText,level:Number.parseInt(v.substring(1))})})};return(o,f)=>{const s=b("router-link"),l=b("CategoryItem");return n(),c("div",L,[e("div",q,[e("div",A,i(a.value.title),1),e("div",E,[e("span",R,i(a.value.createTime),1),e("span",V,[d("作者："),_(s,{to:"/user",class:"a-link"},{default:h(()=>[d(i(a.value.nickName),1)]),_:1})]),e("span",z,[d("分类专栏："),_(s,{to:"/category",class:"a-link"},{default:h(()=>[d(i(a.value.categoryName),1)]),_:1})])]),e("div",{innerHTML:a.value.content,class:"content",id:"content"},null,8,F)]),e("div",{class:"right",style:N({left:g.value+"px"})},[M,e("div",J,[u.value.length==0?(n(),c("div",U,"暂无目录")):(n(!0),c(C,{key:1},H(u.value,t=>(n(),c("div",{key:t.id},[e("div",{class:"tocitem",style:N({"padding-left":(t.level-1)*15+5+"px"})},[e("a",{href:"#"+t.id},i(t.title),9,W)],4)]))),128))]),e("div",j,[G,_(s,{to:"/category",class:"a-link"},{default:h(()=>[d("更多>>")]),_:1})]),e("div",K,[(n(!0),c(C,null,H(m.value,t=>(n(),c("div",{key:t},[_(l,{cover:t.cover,name:t.categoryName,count:t.blogCount,categoryId:t.categoryId,type:0},null,8,["cover","name","count","categoryId"])]))),128))])],4)])}}};export{Z as default};
