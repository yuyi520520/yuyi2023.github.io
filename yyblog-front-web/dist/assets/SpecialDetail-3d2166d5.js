import{i as T,k as L,r as s,a as S,o as c,c as n,b as e,p as D,t as u,d as h,l as x,e as H,_ as E,m as N,E as R,F as V,f as q}from"./index-1ca88f23.js";import{H as A}from"./atom-one-light-f4d8b779.js";const U={class:"s_body"},F={class:"left"},M={class:"special_info"},z={class:"cover"},J=["src"],K={key:1,src:E},P={class:"special_panel"},W={class:"name"},j={class:"count"},G={class:"desc"},O={class:"tree"},Q={class:"right"},X=["innerHTML"],Y={key:0,class:"notoc"},Z=["href"],se={__name:"SpecialDetail",setup($){const{proxy:_}=T(),w=L().params.specialId,f={getSpecialDetail:"/view/getSpecialDetail",blogDetail:"/view/getBlogDetail"},m=s(["toc"]),g=s(1100+(window.innerWidth-1350)/2),a=s({}),y=s([]),b=s();(async()=>{let l=await _.Request({url:f.getSpecialDetail,params:{categoryId:w}});if(!l)return;a.value=l.data.blogCategory,y.value=l.data.blogList;const o=l.data.blogList[0].blogId;N(()=>{b.value.setCurrentKey(o)}),p({blogId:o})})();const B={children:"children",label:"title"},I=s({}),p=async l=>{console.log(l.blogId);let o=await _.Request({url:f.blogDetail,params:{blogId:l.blogId}});o&&(I.value=o.data,N(()=>{document.querySelectorAll("pre code").forEach(t=>{A.highlightBlock(t)}),C(),document.body.scrollHeight>window.innerHeight&&(g.value=g.value-4)}))};p();const r=s([]),C=()=>{const l=["H1","H2","H3","H4","H5","H6"],d=document.querySelector("#content").childNodes;r.value=[];let i=0;d.forEach(t=>{let v=t.tagName;if(v==null||!l.includes(v.toUpperCase()))return!0;i++;let k="toc"+i;t.setAttribute("id",k),r.value.push({id:k,title:t.innerText,level:Number.parseInt(v.substring(1))})})};return(l,o)=>{const d=S("el-collapse-item"),i=S("el-collapse");return c(),n("div",U,[e("div",F,[e("div",M,[e("div",z,[a.value.cover?(c(),n("img",{key:0,src:D(_).globalInfo.imageUrl+a.value.cover},null,8,J)):(c(),n("img",K))]),e("div",P,[e("div",W,u(a.value.categoryName),1),e("div",j,"文章数："+u(a.value.blogCount),1)])]),e("div",G,"简介："+u(a.value.categoryDesc),1),e("div",O,[h(D(R),{ref_key:"treeRef",ref:b,class:"filter-tree","node-key":"blogId",data:y.value,props:B,"default-expand-all":"","highlight-current":!0,"expand-on-click-node":!1,onNodeClick:p},null,8,["data"])])]),e("div",Q,[e("div",{innerHTML:I.value.content,class:"content",id:"content"},null,8,X),e("div",{class:"list",style:x({left:g.value+"px"})},[h(i,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=t=>m.value=t)},{default:H(()=>[h(d,{title:"目录结构",name:"toc"},{default:H(()=>[r.value.length==0?(c(),n("div",Y,"暂无目录")):(c(!0),n(V,{key:1},q(r.value,t=>(c(),n("div",{key:t.id,class:"toclist"},[e("div",{class:"tocitem",style:x({"padding-left":(t.level-1)*15+5+"px"})},[e("a",{href:"#"+t.id},u(t.title),9,Z)],4)]))),128))]),_:1})]),_:1},8,["modelValue"])],4)])])}}};export{se as default};
