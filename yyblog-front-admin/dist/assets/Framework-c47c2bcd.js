import{a as R,m as q,r as P,b as h,e,w as s,u as Q,n as W,p as X,f as o,o as w,d as l,i as n,t as V,g as k,q as Z,s as ee,v as g,x as se,y as te,z as x,j as oe}from"./index-accd95a7.js";const le={class:"layout"},ae=l("div",{class:"logo"},"YyBlog's Admin",-1),ne={class:"userinfo"},re=l("span",null,"欢迎回来，",-1),ce={class:"dropdown-link"},ue={class:"avatar"},ie=["src"],_e={class:"publish"},de={class:"menu-panel"},pe=l("span",null,"博客",-1),fe=l("span",null,"设置",-1),ge=l("span",null,"回收站",-1),me={class:"progress-container"},ve={class:"progress-panel"},he={key:0,class:"error"},we=l("div",{class:"info"},"具体错误，请查看日志",-1),ke={key:1,class:"success"},be={key:2,class:"btn-panel"},Ie={__name:"Framework",setup(ye){const{proxy:r}=oe(),C=Q(),B=W(),D=X(),m={getUserInfo:"getUserInfo",logout:"logout",createHtml:"createHtml",checkProgress:"checkProgress"},H=()=>{console.log("open")},j=()=>{console.log("close")},u=R({}),E=()=>{C.push("../set/personal")},F=()=>{r.Confirm("你确定要退出吗？",async()=>{await r.Request({url:m.logout})&&C.push("/login")})};(async()=>{let t=await r.Request({url:m.getUserInfo});t&&(u.value=t.data,u.value.avatar=r.globalInfo.imageUrl+u.value.avatar)})();const c=R(null);q(B,(t,_)=>{c.value=t.path},{immediate:!0,deep:!0}),q(()=>D.state.userInfo,(t,_)=>{const d=r.globalInfo.imageUrl+t.avatar,v=t.nickName;u.value={avatar:d,nickName:v}},{immediate:!0,deep:!0});const M=[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:40},{color:"#6f7ad3",percentage:60},{color:"#1989fa",percentage:80},{color:"#5cb87a",percentage:100}],i=P({title:"发布",buttons:[],show:!1}),a=P({progress:0});let b=null;const z=async()=>{i.show=!0,a.progress=0,a.status=void 0,await r.Request({url:m.createHtml})&&(I(),b=setInterval(()=>{I()},1e3))},I=async()=>{let t=await r.Request({url:m.checkProgress,showLoading:!1});t&&(t.data.result==0?(a.status="exception",a.errorMsg=t.data.errorMsg):a.progress=t.data.progress,a.result=t.data.result,(t.data.progress==100||t.data.result==0)&&b!=null&&clearInterval(b))};return(t,_)=>{const d=o("el-icon"),v=o("el-dropdown-item"),O=o("el-dropdown-menu"),S=o("el-dropdown"),U=o("el-button"),T=o("el-header"),p=o("router-link"),f=o("el-menu-item"),y=o("el-sub-menu"),$=o("el-menu"),A=o("el-aside"),L=o("router-view"),Y=o("el-main"),N=o("el-container"),G=o("el-progress"),J=o("Dialog");return w(),h("div",le,[e(N,null,{default:s(()=>[e(T,{class:"header"},{default:s(()=>[ae,l("div",ne,[re,e(S,{trigger:"click"},{dropdown:s(()=>[e(O,null,{default:s(()=>[e(v,{onClick:E},{default:s(()=>[n(" 个人中心 ")]),_:1}),e(v,{onClick:F},{default:s(()=>[n("退出")]),_:1})]),_:1})]),default:s(()=>[l("span",ce,[n(V(u.value.nickName)+" ",1),e(d,{class:"el-icon--right"},{default:s(()=>[e(k(Z))]),_:1})])]),_:1}),l("div",ue,[l("img",{src:u.value.avatar},null,8,ie)])]),l("div",_e,[e(U,{class:"publish-btn",onClick:z},{default:s(()=>[n("发布")]),_:1})])]),_:1}),e(N,{class:"container"},{default:s(()=>[e(A,{class:"aside"},{default:s(()=>[l("div",de,[e($,{"default-active":"2",class:"menu-demo","background-color":"#F0E6E6",onOpen:H,onClose:j},{default:s(()=>[e(y,{index:"1"},{title:s(()=>[e(d,null,{default:s(()=>[e(k(ee))]),_:1}),pe]),default:s(()=>[e(f,{index:"1-1",class:g([c.value=="/blog/list"?"active":""])},{default:s(()=>[e(p,{to:"/blog/list",class:"routerlink"},{default:s(()=>[n(" 博客管理 ")]),_:1})]),_:1},8,["class"]),e(f,{index:"1-2",class:g([c.value=="/blog/classify"?"active":""])},{default:s(()=>[e(p,{to:"/blog/classify",class:"routerlink"},{default:s(()=>[n(" 分类管理 ")]),_:1})]),_:1},8,["class"]),e(f,{index:"1-3",class:g([c.value=="/blog/subject"?"active":""])},{default:s(()=>[e(p,{to:"/blog/subject",class:"routerlink"},{default:s(()=>[n(" 专题管理 ")]),_:1})]),_:1},8,["class"])]),_:1}),e(y,{index:"2"},{title:s(()=>[e(d,null,{default:s(()=>[e(k(se))]),_:1}),fe]),default:s(()=>[e(f,{index:"2-1",class:g([c.value=="/set/personal"?"active":""])},{default:s(()=>[e(p,{to:"/set/personal",class:"routerlink"},{default:s(()=>[n(" 个人信息设置 ")]),_:1})]),_:1},8,["class"]),e(f,{index:"2-2",class:g([c.value=="/set/system"?"active":""])},{default:s(()=>[e(p,{to:"/set/system",class:"routerlink"},{default:s(()=>[n(" 系统设置 ")]),_:1})]),_:1},8,["class"])]),_:1}),e(y,{index:"3"},{title:s(()=>[e(d,null,{default:s(()=>[e(k(te))]),_:1}),ge]),default:s(()=>[e(f,{index:"3-1",class:g([c.value=="/recycle"?"active":""])},{default:s(()=>[e(p,{to:"/recycle",class:"routerlink"},{default:s(()=>[n(" 回收站 ")]),_:1})]),_:1},8,["class"])]),_:1})]),_:1})])]),_:1}),e(Y,{class:"main"},{default:s(()=>[e(L)]),_:1})]),_:1})]),_:1}),e(J,{show:i.show,title:i.title,buttons:i.buttons,onClose:_[1]||(_[1]=K=>i.show=!1),"show-close":!1,showCancel:!1,width:"400px"},{default:s(()=>[l("div",me,[l("div",ve,[e(G,{type:"circle",percentage:a.progress,status:a.status,color:M},null,8,["percentage","status"])]),a.result==0?(w(),h("div",he,[l("div",null,"生成页面出错了："+V(a.errorMsg),1),we])):x("",!0),a.progress==100&&a.result==1?(w(),h("div",ke," 发布成功 ")):x("",!0),a.progress==100||a.result==0?(w(),h("div",be,[e(U,{class:"btn",type:"primary",onClick:_[0]||(_[0]=K=>i.show=!1)},{default:s(()=>[n("关闭")]),_:1})])):x("",!0)])]),_:1},8,["show","title","buttons"])])}}};export{Ie as default};
