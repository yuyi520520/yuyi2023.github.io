import{a as j,r as f,b as a,d,e as t,w as o,J as w,u as D,j as F,f as n,o as i,G as $,i as g,t as r,F as L}from"./index-accd95a7.js";const q={class:"body"},K={class:"top-panel"},M={key:0,style:{color:"green"}},O={key:1,style:{color:"red"}},U=["onClick"],A={key:1},E=["onClick"],G={key:3},H={key:1},Q={__name:"Recycle",setup(J){D();const{proxy:c}=F(),v={loadDataList:"/blog/loadRecoveryList",delBlog:"/blog/delBlog",reductionBlog:"/blog/reductionBlog"},p=j(c.VueCookies.get("userInfo")||{}),_=f({}),k=f({extHeight:40}),I=[{label:"封面",prop:"cover",width:80,scopedSlots:"cover"},{label:"文章信息",prop:"title",scopedSlots:"blogInfo"},{label:"编辑器",prop:"editorTypeName",width:100},{label:"评论",prop:"allowCommentTypeName",width:80},{label:"时间",prop:"createTime",scopedSlots:"timeInfo",width:260},{label:"操作",prop:"operation",width:150,scopedSlots:"operation"}],m=f({}),u=async()=>{let s={pageNo:_.pageNo,pageSize:_.pageSize};Object.assign(s,m);let l=await c.Request({url:v.loadDataList,params:s});l&&Object.assign(_,l.data)},C=s=>{c.Confirm(`确认要删除【${s.title}】吗，删除后无法找回？`,async()=>{await c.Request({url:v.delBlog,params:{blogId:s.blogId}})&&(c.Message.success("删除成功"),u())})},B=s=>{c.Confirm(`确认要恢复【${s.title}】吗？恢复后博客为草稿状态。`,async()=>{await c.Request({url:v.reductionBlog,params:{blogId:s.blogId}})&&(c.Message.success("恢复成功"),u())})};return(s,l)=>{const N=n("el-input"),b=n("el-form-item"),y=n("el-col"),T=n("el-button"),S=n("el-row"),V=n("el-form"),x=n("cover"),h=n("el-divider"),z=n("Table");return i(),a("div",q,[d("div",K,[t(V,{onSubmit:l[2]||(l[2]=w(()=>{},["prevent"])),model:m,class:"search-form",labelAlign:"left"},{default:o(()=>[t(S,{gutter:5},{default:o(()=>[t(y,{span:5},{default:o(()=>[t(b,{label:"标题"},{default:o(()=>[t(N,{modelValue:m.titleFuzzy,"onUpdate:modelValue":l[0]||(l[0]=e=>m.titleFuzzy=e),placeholder:"支持模糊搜索",onKeyup:$(u,["enter"]),allowClear:""},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),t(y,{span:5},{default:o(()=>[t(b,null,{default:o(()=>[t(T,{type:"danger",onClick:l[1]||(l[1]=e=>u())},{default:o(()=>[g("搜索")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),t(z,{columns:I,fetch:u,dataSource:_,options:k},{cover:o(({row:e})=>[t(x,{cover:e.cover},null,8,["cover"])]),blogInfo:o(({row:e})=>[d("div",null,"标题："+r(e.title),1),d("div",null,[g("文章类型："+r(e.blogType==0?"博客":"专题")+" ",1),t(h,{direction:"vertical"}),g(),d("span",null,r(e.blogType==0?"分类":"专题"),1),g(":"+r(e.categoryName||"--"),1)]),d("div",null,"作者："+r(e.nickName),1)]),status:o(({row:e})=>[e.status==1?(i(),a("span",M,r(e.statusName),1)):(i(),a("span",O,r(e.statusName),1))]),timeInfo:o(({row:e})=>[d("div",null,"创建时间："+r(e.createTime),1),d("div",null,"更新时间："+r(e.lastUpdateTime),1)]),operation:o(({row:e})=>[e.userId==p.value.userId||p.value.roleType==1?(i(),a(L,{key:0},[p.value.userId==e.userId?(i(),a("a",{key:0,class:"a-link",href:"javascript:void(0)",onClick:R=>B(e)},"还原",8,U)):(i(),a("span",A,"--")),t(h,{direction:"vertical"}),p.value.userId==e.userId?(i(),a("a",{key:2,class:"a-link",href:"javascript:void(0)",onClick:R=>C(e)},"删除",8,E)):(i(),a("span",G,"--"))],64)):(i(),a("span",H,"--"))]),_:1},8,["dataSource","options"])])}}};export{Q as default};
