import{r as C,a as T,b as U,e as a,w as c,H as L,f as s,o as I,i as O,d as u,v as V,j as z}from"./index-accd95a7.js";const E={class:"op"},F=["onClick"],H=["onClick"],M=["onClick"],A=["onClick"],J={__name:"Classify",setup(P){const{proxy:i}=z(),p={loadDataList:"/category/loadAllCategory4Blog",saveCategory:"/category/saveCategory4Blog",delCategory:"category/delCategory4Blog",changeSort:"category/changeCategorySort4Blog"},N=[{label:"封面",prop:"cover",width:100,scopedSlots:"cover"},{label:"名称",prop:"categoryName",width:200},{label:"简介",prop:"categoryDesc"},{label:"博客数量",prop:"blogCount",width:100},{label:"操作",prop:"op",width:200,scopedSlots:"op"}],m=C({}),j={extHeight:10},g=async()=>{let t=await i.Request({url:p.loadDataList});t&&(m.list=t.data)},r=C({show:!1,title:"标题",buttons:[{type:"danger",text:"确定",click:t=>{S()}}]}),l=C({}),R={categoryName:[{required:!0,message:"请输入分类名称"}]},v=T(),w=(t,e)=>{r.show=!0,L(()=>{v.value.resetFields(),t=="add"?r.title="新增分类":t=="update"&&(r.title="编辑分类",Object.assign(l,e))})},S=()=>{v.value.validate(async t=>{if(!t)return;let e={};Object.assign(e,l),await i.Request({url:p.saveCategory,params:e})&&(r.show=!1,i.Message.success("保存成功"),g())})},B=t=>{i.Confirm(`你确定要删除${t.categoryName}`,async()=>{await i.Request({url:p.delCategory,params:{categoryId:t.categoryId}})&&g()})},h=async(t,e)=>{let n=m.list;if(e==="down"&&t===n.length-1||e==="up"&&t===0)return;let f=n[t],d=e=="down"?1:-1;n.splice(t,1),n.splice(t+d,0,f),await i.Request({url:p.changeSort,dataType:"json",params:n})&&(i.Message.success("重新排序成功"),g())};return(t,e)=>{const n=s("el-button"),f=s("Cover"),d=s("el-divider"),b=s("Table"),k=s("el-input"),_=s("el-form-item"),$=s("CoverUpload"),q=s("el-form"),x=s("Dialog");return I(),U("div",null,[a(n,{type:"danger",round:"",onClick:e[0]||(e[0]=o=>w("add"))},{default:c(()=>[O("新增分类")]),_:1}),a(b,{columns:N,showPagination:!1,dataSource:m,fetch:g,options:j},{cover:c(({row:o})=>[a(f,{cover:o.cover},null,8,["cover"])]),op:c(({index:o,row:D})=>[u("div",E,[u("a",{href:"javascript:void(0)",class:"a-link",onClick:y=>w("update",D)},"修改",8,F),a(d,{direction:"vertical"}),u("a",{href:"javascript:void(0)",class:"a-link",onClick:y=>B(D)},"删除",8,H),a(d,{direction:"vertical"}),u("a",{href:"javascript:void(0)",class:V([o==0?"not-allow":"a-link"]),onClick:y=>h(o,"up")},"上移",10,M),a(d,{direction:"vertical"}),u("a",{href:"javascript:void(0)",class:V([o==m.list.length-1?"not-allow":"a-link"]),onClick:y=>h(o,"down")},"下移",10,A)])]),_:1},8,["dataSource"]),a(x,{show:r.show,title:r.title,buttons:r.buttons,width:"500px",onClose:e[4]||(e[4]=o=>r.show=!1)},{default:c(()=>[a(q,{model:l,rules:R,ref_key:"formDataRef",ref:v,"label-width":"80px"},{default:c(()=>[a(_,{label:"名称",prop:"categoryName"},{default:c(()=>[a(k,{placeholder:"请输入名称",modelValue:l.categoryName,"onUpdate:modelValue":e[1]||(e[1]=o=>l.categoryName=o)},null,8,["modelValue"])]),_:1}),a(_,{label:"封面",prop:"cover"},{default:c(()=>[a($,{modelValue:l.cover,"onUpdate:modelValue":e[2]||(e[2]=o=>l.cover=o)},null,8,["modelValue"])]),_:1}),a(_,{label:"简介",prop:"categoryDesc"},{default:c(()=>[a(k,{modelValue:l.categoryDesc,"onUpdate:modelValue":e[3]||(e[3]=o=>l.categoryDesc=o),type:"textarea",placeholder:"请输入简介",autosize:{minRows:4,maxRows:4}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])])}}};export{J as default};
